<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>pANEL — Login</title>
<link rel="stylesheet" href="css/style.css"/>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>
<style>
/* ── Role selector cards ── */
.role-select-grid {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 11px;
  margin: 24px 0 6px;
}
.role-card {
  position: relative;
  display: flex; flex-direction: column; align-items: center;
  gap: 8px; padding: 20px 10px 16px;
  border-radius: 14px;
  border: 2px solid var(--border2);
  background: var(--bg-input);
  cursor: pointer;
  transition: all 0.22s cubic-bezier(.4,0,.2,1);
  user-select: none;
}
.role-card:hover { transform: translateY(-3px); }
.role-card .rc-icon {
  width: 46px; height: 46px; border-radius: 13px;
  display: flex; align-items: center; justify-content: center;
  font-size: 20px;
  transition: all 0.22s ease;
}
.role-card .rc-name   { font-size: 13px; font-weight: 700; }
.role-card .rc-desc   { font-size: 10.5px; color: var(--text-3); text-align: center; line-height: 1.4; }
.role-card .rc-arrow  {
  position: absolute; top: 10px; right: 10px;
  font-size: 10px; color: var(--text-3);
  opacity: 0; transition: opacity 0.2s;
}
.role-card:hover .rc-arrow { opacity: 1; }

/* Role-specific colors */
.role-card.owner  .rc-icon { background: #fef9c3;  color: #92400e; }
.role-card.admin  .rc-icon { background: #ede9fe; color: #6d28d9; }
.role-card.master .rc-icon { background: #dbeafe; color: #1d4ed8; }
.role-card.seller .rc-icon { background: #dcfce7;  color: #15803d; }
.role-card.developer .rc-icon { background: #fee2e2; color: #b91c1c; }

.role-card.owner:hover,  .role-card.owner.selected  { border-color: #d97706; box-shadow: 0 0 18px rgba(217,119,6,0.15); }
.role-card.admin:hover,  .role-card.admin.selected  { border-color: #7c3aed; box-shadow: 0 0 18px rgba(124,58,237,0.18); }
.role-card.master:hover, .role-card.master.selected { border-color: #2563eb; box-shadow: 0 0 18px rgba(37,99,235,0.16); }
.role-card.seller:hover, .role-card.seller.selected { border-color: #16a34a; box-shadow: 0 0 18px rgba(22,163,74,0.15); }
.role-card.developer:hover, .role-card.developer.selected { border-color: #dc2626; box-shadow: 0 0 18px rgba(220,38,38,0.15); }

/* Selected check */
.role-card.selected::after {
  content: '✓';
  position: absolute; top: 8px; right: 10px;
  font-size: 12px; font-weight: 800;
  color: white;
}
.role-card.owner.selected::after  { color: #92400e; }
.role-card.admin.selected::after  { color: #6d28d9; }
.role-card.master.selected::after { color: #1d4ed8; }
.role-card.seller.selected::after { color: #15803d; }
.role-card.developer.selected::after { color: #b91c1c; }

/* Developer card spans full row */
.role-card.developer { grid-column: span 2; flex-direction: row; gap: 14px; padding: 16px 20px; }
.role-card.developer .rc-desc { text-align: left; }

/* Step transition */
.auth-step { transition: opacity 0.3s ease, transform 0.3s ease; }
.auth-step.hidden { display: none; }

/* Selected role header in step 2 */
.selected-role-header {
  display: flex; align-items: center; gap: 12px;
  padding: 12px 16px; border-radius: 12px;
  margin-bottom: 22px;
  border: 1.5px solid var(--border2);
  background: var(--bg-input);
}
.srh-icon {
  width: 38px; height: 38px; border-radius: 10px;
  display: flex; align-items: center; justify-content: center;
  font-size: 17px; flex-shrink: 0;
}
.srh-info { flex: 1; }
.srh-role { font-size: 14px; font-weight: 700; }
.srh-sub  { font-size: 11px; color: var(--text-3); margin-top: 2px; }
.srh-change {
  font-size: 11.5px; color: var(--accent-purple); cursor: pointer;
  font-weight: 600; white-space: nowrap;
  padding: 5px 10px; border-radius: 6px;
  border: 1px solid rgba(124,58,237,0.3);
  transition: all 0.2s;
}
.srh-change:hover { background: rgba(124,58,237,0.12); }

/* Step dots */
.step-dots {
  display: flex; justify-content: center; gap: 7px; margin-bottom: 20px;
}
.step-dot {
  width: 8px; height: 8px; border-radius: 50%;
  background: var(--border2); transition: all 0.3s ease;
}
.step-dot.active { background: var(--accent-purple); width: 22px; border-radius: 4px; }
</style>
</head>
<body class="auth-body">

<!-- Background orbs -->
<div class="orb orb-1"></div>
<div class="orb orb-2"></div>
<div class="orb orb-3"></div>

<div class="auth-wrapper">
  <div class="auth-card" id="loginCard">

    <!-- Logo -->
    <div class="auth-logo">
      <div class="logo-icon">
        <svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg" width="26" height="26">
          <!-- sidebar strip -->
          <rect x="2" y="2" width="10" height="36" rx="3" fill="white"/>
          <!-- topbar -->
          <rect x="15" y="2" width="23" height="9" rx="3" fill="white" opacity="0.82"/>
          <!-- main content -->
          <rect x="15" y="14" width="10" height="24" rx="3" fill="white" opacity="0.65"/>
          <!-- widget top-right -->
          <rect x="28" y="14" width="10" height="11" rx="2.5" fill="white" opacity="0.65"/>
          <!-- widget bottom-right -->
          <rect x="28" y="28" width="10" height="10" rx="2.5" fill="white" opacity="0.65"/>
        </svg>
      </div>
      <span class="logo-text"><span class="lt-p">p</span>ANEL</span>
    </div>
    <p class="auth-subtitle">Secure Multi-Role Access System</p>

    <!-- Step dots -->
    <div class="step-dots">
      <div class="step-dot active" id="dot1"></div>
      <div class="step-dot" id="dot2"></div>
    </div>

    <!-- ══ STEP 1: Role Selection ══ -->
    <div class="auth-step" id="step1">
      <p style="text-align:center;font-size:13px;color:var(--text-2);margin-bottom:4px">
        <i class="fa-solid fa-hand-pointer" style="margin-right:6px;color:var(--accent-purple)"></i>
        Select your role to continue
      </p>

      <div class="role-select-grid">

        <!-- Owner -->
        <div class="role-card owner" onclick="selectRole('owner')">
          <div class="rc-arrow"><i class="fa-solid fa-arrow-right"></i></div>
          <div class="rc-icon"><i class="fa-solid fa-crown"></i></div>
          <div class="rc-name">Owner</div>
          <div class="rc-desc">Full system control &amp; master access</div>
        </div>

        <!-- Admin -->
        <div class="role-card admin" onclick="selectRole('admin')">
          <div class="rc-arrow"><i class="fa-solid fa-arrow-right"></i></div>
          <div class="rc-icon"><i class="fa-solid fa-user-shield"></i></div>
          <div class="rc-name">Admin</div>
          <div class="rc-desc">Manage masters, sellers &amp; keys</div>
        </div>

        <!-- Master -->
        <div class="role-card master" onclick="selectRole('master')">
          <div class="rc-arrow"><i class="fa-solid fa-arrow-right"></i></div>
          <div class="rc-icon"><i class="fa-solid fa-star"></i></div>
          <div class="rc-name">Master</div>
          <div class="rc-desc">Manage sellers &amp; generate keys</div>
        </div>

        <!-- Seller -->
        <div class="role-card seller" onclick="selectRole('seller')">
          <div class="rc-arrow"><i class="fa-solid fa-arrow-right"></i></div>
          <div class="rc-icon"><i class="fa-solid fa-tags"></i></div>
          <div class="rc-name">Seller</div>
          <div class="rc-desc">Generate &amp; sell license keys</div>
        </div>

        <!-- Developer (spans full row) -->
        <div class="role-card developer" onclick="selectRole('developer')">
          <div class="rc-arrow"><i class="fa-solid fa-arrow-right"></i></div>
          <div class="rc-icon"><i class="fa-solid fa-code"></i></div>
          <div>
            <div class="rc-name">Developer</div>
            <div class="rc-desc">API access &amp; system integration tools</div>
          </div>
        </div>

      </div>
    </div>

    <!-- ══ STEP 2: Login Form ══ -->
    <div class="auth-step hidden" id="step2">

      <!-- Selected role banner -->
      <div class="selected-role-header" id="roleHeader">
        <div class="srh-icon" id="roleHeaderIcon"></div>
        <div class="srh-info">
          <div class="srh-role" id="roleHeaderName">Role</div>
          <div class="srh-sub" id="roleHeaderSub">Enter credentials below</div>
        </div>
        <span class="srh-change" onclick="goBack()">
          <i class="fa-solid fa-arrow-left" style="margin-right:4px"></i>Change
        </span>
      </div>

      <!-- Login Form -->
      <form id="loginForm" autocomplete="off">
        <div class="form-group">
          <label><i class="fa-solid fa-user"></i> Username</label>
          <input type="text" id="loginUsername" placeholder="Enter your username" autocomplete="off" spellcheck="false" required/>
        </div>
        <div class="form-group">
          <label><i class="fa-solid fa-lock"></i> Password</label>
          <div class="pw-wrap">
            <input type="password" id="loginPassword" placeholder="Any length — e.g. 123 or abc" required/>
            <button type="button" class="pw-toggle" onclick="togglePw('loginPassword',this)">
              <i class="fa-regular fa-eye"></i>
            </button>
          </div>
        </div>

        <!-- Status -->
        <div class="auth-status" id="loginStatus"></div>

        <button type="submit" class="btn-primary" id="loginBtn">
          <span class="btn-text"><i class="fa-solid fa-right-to-bracket"></i> Sign In</span>
          <span class="btn-loader" style="display:none"><i class="fa-solid fa-spinner fa-spin"></i> Authenticating…</span>
        </button>
      </form>

      <p class="auth-footer">
        <i class="fa-solid fa-circle-info"></i>
        Need access? Contact your <strong>Owner / Admin</strong>.
        Username &amp; password are set by your admin.
      </p>
    </div>

  </div>
</div>

<!-- Firebase & App scripts -->
<script type="module" src="js/firebase-config.js"></script>
<script type="module" src="js/auth.js"></script>
<script>
// Role metadata
const ROLES = {
  owner:     { label:'Owner',     icon:'fa-crown',       color:'#92400e', bg:'#fef9c3', sub:'Full system access',         cls:'owner' },
  admin:     { label:'Admin',     icon:'fa-user-shield', color:'#6d28d9', bg:'#ede9fe', sub:'Team management access',      cls:'admin' },
  master:    { label:'Master',    icon:'fa-star',        color:'#1d4ed8', bg:'#dbeafe', sub:'Seller management access',    cls:'master' },
  seller:    { label:'Seller',    icon:'fa-tags',        color:'#15803d', bg:'#dcfce7', sub:'Key generation access',       cls:'seller' },
  developer: { label:'Developer', icon:'fa-code',        color:'#b91c1c', bg:'#fee2e2', sub:'API & developer tools access', cls:'developer' },
};

let selectedRole = null;

function selectRole(role) {
  selectedRole = role;
  const r = ROLES[role];

  // Update role header in step 2
  document.getElementById('roleHeaderIcon').style.background = '';
  document.getElementById('roleHeaderIcon').innerHTML =
    `<i class="fa-solid ${r.icon}" style="color:${r.color}"></i>`;
  document.getElementById('roleHeaderIcon').style.cssText =
    `width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:17px;flex-shrink:0;background:${r.bg};`;
  document.getElementById('roleHeaderName').textContent = r.label + ' Login';
  document.getElementById('roleHeaderSub').textContent  = r.sub;

  // Animate transition
  const s1 = document.getElementById('step1');
  const s2 = document.getElementById('step2');
  s1.style.opacity = '0';
  s1.style.transform = 'translateX(-20px)';
  setTimeout(() => {
    s1.classList.add('hidden');
    s2.classList.remove('hidden');
    s2.style.opacity = '0';
    s2.style.transform = 'translateX(20px)';
    requestAnimationFrame(() => {
      s2.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
      s2.style.opacity = '1';
      s2.style.transform = 'translateX(0)';
    });
    document.getElementById('loginUsername').focus();
  }, 250);

  // Step dots
  document.getElementById('dot1').classList.remove('active');
  document.getElementById('dot2').classList.add('active');

  // Store for auth.js
  window.__selectedRole = role;
}

function goBack() {
  const s1 = document.getElementById('step1');
  const s2 = document.getElementById('step2');
  s2.style.opacity = '0';
  s2.style.transform = 'translateX(20px)';
  setTimeout(() => {
    s2.classList.add('hidden');
    s1.classList.remove('hidden');
    s1.style.opacity = '0';
    s1.style.transform = 'translateX(-20px)';
    requestAnimationFrame(() => {
      s1.style.transition = 'opacity 0.3s ease, transform 0.3s ease';
      s1.style.opacity = '1';
      s1.style.transform = 'translateX(0)';
    });
  }, 220);
  document.getElementById('dot1').classList.add('active');
  document.getElementById('dot2').classList.remove('active');
  document.getElementById('loginStatus').className = 'auth-status';
  document.getElementById('loginStatus').textContent = '';
  selectedRole = null;
  window.__selectedRole = null;
}

function togglePw(id, btn) {
  const inp = document.getElementById(id);
  if (inp.type === 'password') { inp.type='text'; btn.innerHTML='<i class="fa-regular fa-eye-slash"></i>'; }
  else { inp.type='password'; btn.innerHTML='<i class="fa-regular fa-eye"></i>'; }
}
</script>
</body>
</html>
